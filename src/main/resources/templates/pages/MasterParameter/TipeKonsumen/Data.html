<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" lang="en">
<head th:replace="fragments/common :: head">

</head>
<body class="c-app">
    <div th:replace="fragments/common :: sidebar"></div>
    <div class="c-wrapper">
        <div th:replace="fragments/common :: header"></div>
        <div class="c-body">
          <main class="c-main">
            <div class="container-fluid">
              <div class="fade-in">
                <div class="row"> 
                  <div class="col-12">
                    <div class="card">
                      <div class="card-header"> Data - Tujuan Penggunaan
                        <a href="/TipeKonsumen/InputData"><button class="btn btn-sm btn-ghost-success" type="button">Input Data</button></a>
                        <a href="/TipeKonsumen/ExportData"><button class="btn btn-sm btn-ghost-success" type="button">Export Data</button></a>
                        <a href="/TipeKonsumen/ImportData"><button class="btn btn-sm btn-ghost-success" type="button">Import Data</button></a>
                      </div>
                      <div class="card-body">
                        <table id="example" class="table table-striped table-bordered datatables" style="width:100%;">
                          <thead>
                            <tr role="row">
                              <th></th>
                              <th id="fil-nama"></th>
                              <th></th>
                              <th></th>
                              <th></th>
                              <th></th>
                              <th></th>
                              <th></th>
                            </tr>
                            <tr role="filter">
                              <th data-value="actions">Actions</th>
                              <th data-value="nama">Nama</th>
                              <th data-value="produk">Produk</th>
                              <th data-value="deskripsi">Deskripsi</th>
                              <th data-value="start_date">Start Date</th>
                              <th data-value="end_date">End Date</th>
                              <th data-value="status">Status</th>
                              <th data-value="remarks">Remarks</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr th:each="tipeKonsumen :${listDataTipeKonsumen}">
                              <td>
                                <a class="btn btn-success" href="/TipeKonsumen/EditData">
                                <svg class="c-icon">
                                  <use xlink:href="../vendors/@coreui/icons/svg/free.svg#cil-pen">
                                  </use>
                                </svg></a>
                                </td>
                                
                                <td th:text="${tipeKonsumen.nama}" th:attr="data-filter=${tipeKonsumen.nama}"></td>
                                <td th:text="${tipeKonsumen.produk}" th:attr="data-filter=${tipeKonsumen.produk}"></td>
                                <td th:text="${tipeKonsumen.deskripsi}" th:attr="data-filter=${tipeKonsumen.deskripsi}"></td>
                                <td th:text="${tipeKonsumen.start_date}" th:attr="data-filter=${tipeKonsumen.start_date}"></td>
                                <td th:text="${tipeKonsumen.end_date}" th:attr="data-filter=${tipeKonsumen.end_date}"></td>

                                <td th:if="${tipeKonsumen.is_approved == null and tipeKonsumen.is_rejected == null}" data-filter="Draft">
                                  <span class="badge badge-primary">Draft</span>
                                </td>
                                <td th:if="${tipeKonsumen.is_approved == 0 and tipeKonsumen.is_rejected == 0}" data-filter="Submitted">
                                  <span class="badge badge-warning">Submitted</span>
                                </td>
                                <td th:if="${tipeKonsumen.is_approved == 1}"  data-filter="Approved">
                                  <span class="badge badge-success">Approved</span>
                                </td>
                                <td th:if="${tipeKonsumen.is_rejected == 1}" data-filter="Rejected">
                                  <span class="badge badge-danger">Rejected</span>
                                </td>

                                <td th:text="${tipeKonsumen.remarks}"></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </main>
        </div>
        <div th:replace="fragments/common :: footer"></div>
    </div>
    <div th:replace="fragments/common :: scripts"></div>
    <script>
      let _FILTER_COLUMN = ['nama','produk','status'];
      
      $('.datatables').DataTable( {
          initComplete: function () {
              this.api().columns().every( function () {
                if(_FILTER_COLUMN.includes($(this.header()).data('value'))) {

                  var column = this;
                  var select = $('<select><option value=""></option></select>')
                      .appendTo( $(column.footer()).empty() )
                      .on( 'change', function () {
                          var val = $.fn.dataTable.util.escapeRegex(
                              $(this).val()
                          );
  
                          column
                              .search( val ? '^'+val+'$' : '', true, false )
                              .draw();
                      } );

                  let filters = [];
                  $.map(column.nodes(), function (item) {
                    filters.push($(item).data('filter'));
                  })
                  
                  filters = [...new Set(filters)];
                  
                  filters.forEach(function (data) {
                    select.append( '<option value="'+data+'">'+data+'</option>' )
                  })
                }
              } );
          }
      } );
  </script>
</body>
</html>



